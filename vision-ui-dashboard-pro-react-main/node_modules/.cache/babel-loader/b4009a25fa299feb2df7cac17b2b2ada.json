{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EsdtHelpers = void 0;\n\nconst scArgumentsParser_1 = require(\"./scArgumentsParser\");\n\nconst errors_1 = require(\"./errors\");\n\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\n\nconst constants_1 = require(\"./constants\");\n/**\n * This class exposes static methods that are useful for parsing ESDT transfer transactions\n */\n\n\nclass EsdtHelpers {\n  /**\n   * This function will return the token identifier and the amount from a given data field for an ESDT transfer, or\n   * an exception if something went wrong\n   * @param dataField this field represents the data filed to extract esdt transfer data from\n   * @throws ErrInvalidEsdtTransferDataField this function throws an ErrInvalidEsdtTransferDataField if the provided data field isn't meant to be an ESDT transfer\n   * @return {tokenIdentifier, amount} this function returns a pair of token identifier and amount to transfer\n   */\n  static extractFieldsFromEsdtTransferDataField(dataField) {\n    if (!dataField.startsWith(constants_1.ESDT_TRANSFER_FUNCTION_NAME + \"@\")) {\n      throw new errors_1.ErrInvalidEsdtTransferDataField();\n    }\n\n    let {\n      args\n    } = scArgumentsParser_1.ScArgumentsParser.parseSmartContractCallDataField(dataField);\n\n    if (args.length != 2) {\n      throw new errors_1.ErrInvalidEsdtTransferDataField();\n    }\n\n    let tokenIdentifier = args[0];\n    let amount = new bignumber_js_1.default(args[1], 16).toString(10);\n    return {\n      tokenIdentifier: tokenIdentifier,\n      amount: amount\n    };\n  }\n  /**\n   * This function checks if the data field represents a valid ESDT transfer call\n   * @param dataField this field represents the string to be checked if it would trigger an ESDT transfer call\n   * @return true if the provided data field is meant to be an ESDT transfer\n   */\n\n\n  static isEsdtTransferTransaction(dataField) {\n    if (!dataField.startsWith(constants_1.ESDT_TRANSFER_FUNCTION_NAME + \"@\")) {\n      return false;\n    }\n\n    let args;\n\n    try {\n      args = scArgumentsParser_1.ScArgumentsParser.parseSmartContractCallDataField(dataField).args;\n    } catch (e) {\n      return false;\n    }\n\n    return args.length === 2;\n  }\n  /**\n   * getTxFieldsForEsdtTransfer returns the needed value, gasLimit and data field (in string format) for sending an amount of ESDT token\n   * @param tokenIdentifier this field represents the identifier of the token to transfer\n   * @param amount this field represents the denominated amount of the token to send\n   * @return {value, gasLimit, data} this function returns the value, the gas limit and the data field to use\n   */\n\n\n  static getTxFieldsForEsdtTransfer(tokenIdentifier, amount) {\n    const encodedAmount = new bignumber_js_1.default(amount, 10).toString(16);\n    const txDataField = [constants_1.ESDT_TRANSFER_FUNCTION_NAME, tokenIdentifier, encodedAmount].join(\"@\");\n    return {\n      value: constants_1.ESDT_TRANSFER_VALUE,\n      gasLimit: constants_1.ESDT_TRANSFER_GAS_LIMIT,\n      data: txDataField\n    };\n  }\n\n}\n\nexports.EsdtHelpers = EsdtHelpers;","map":{"version":3,"sources":["../src/esdtHelpers.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,MAAA,mBAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AACA,MAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,MAAA,cAAA,GAAA,eAAA,CAAA,OAAA,CAAA,cAAA,CAAA,CAAA;;AACA,MAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;AAEA;;AAEG;;;AACH,MAAa,WAAb,CAAwB;EAEpB;;;;;;AAMG;EACiD,OAAtC,sCAAsC,CAAC,SAAD,EAAkB;IAClE,IAAI,CAAC,SAAS,CAAC,UAAV,CAAqB,WAAA,CAAA,2BAAA,GAA8B,GAAnD,CAAL,EAA8D;MAC1D,MAAM,IAAI,QAAA,CAAA,+BAAJ,EAAN;IACH;;IAED,IAAI;MAAC;IAAD,IAAS,mBAAA,CAAA,iBAAA,CAAkB,+BAAlB,CAAkD,SAAlD,CAAb;;IAEA,IAAI,IAAI,CAAC,MAAL,IAAe,CAAnB,EAAsB;MAClB,MAAM,IAAI,QAAA,CAAA,+BAAJ,EAAN;IACH;;IAED,IAAI,eAAe,GAAG,IAAI,CAAC,CAAD,CAA1B;IACA,IAAI,MAAM,GAAG,IAAI,cAAA,CAAA,OAAJ,CAAc,IAAI,CAAC,CAAD,CAAlB,EAAuB,EAAvB,EAA2B,QAA3B,CAAoC,EAApC,CAAb;IAEA,OAAO;MACH,eAAe,EAAE,eADd;MAEH,MAAM,EAAE;IAFL,CAAP;EAIH;EAED;;;;AAIG;;;EACoC,OAAzB,yBAAyB,CAAC,SAAD,EAAkB;IACrD,IAAI,CAAC,SAAS,CAAC,UAAV,CAAqB,WAAA,CAAA,2BAAA,GAA8B,GAAnD,CAAL,EAA8D;MAC1D,OAAO,KAAP;IACH;;IAED,IAAI,IAAJ;;IACA,IAAI;MACA,IAAI,GAAG,mBAAA,CAAA,iBAAA,CAAkB,+BAAlB,CAAkD,SAAlD,EAA6D,IAApE;IACH,CAFD,CAEE,OAAO,CAAP,EAAU;MACR,OAAO,KAAP;IACH;;IAED,OAAO,IAAI,CAAC,MAAL,KAAgB,CAAvB;EACH;EAED;;;;;AAKG;;;EACqC,OAA1B,0BAA0B,CAAC,eAAD,EAA0B,MAA1B,EAAwC;IAC5E,MAAM,aAAa,GAAG,IAAI,cAAA,CAAA,OAAJ,CAAc,MAAd,EAAsB,EAAtB,EAA0B,QAA1B,CAAmC,EAAnC,CAAtB;IACA,MAAM,WAAW,GAAG,CAAC,WAAA,CAAA,2BAAD,EAA8B,eAA9B,EAA+C,aAA/C,EAA8D,IAA9D,CAAmE,GAAnE,CAApB;IAEA,OAAO;MACH,KAAK,EAAE,WAAA,CAAA,mBADJ;MAEH,QAAQ,EAAE,WAAA,CAAA,uBAFP;MAGH,IAAI,EAAE;IAHH,CAAP;EAKH;;AAhEmB;;AAAxB,OAAA,CAAA,WAAA,GAAA,WAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EsdtHelpers = void 0;\nconst scArgumentsParser_1 = require(\"./scArgumentsParser\");\nconst errors_1 = require(\"./errors\");\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nconst constants_1 = require(\"./constants\");\n/**\n * This class exposes static methods that are useful for parsing ESDT transfer transactions\n */\nclass EsdtHelpers {\n    /**\n     * This function will return the token identifier and the amount from a given data field for an ESDT transfer, or\n     * an exception if something went wrong\n     * @param dataField this field represents the data filed to extract esdt transfer data from\n     * @throws ErrInvalidEsdtTransferDataField this function throws an ErrInvalidEsdtTransferDataField if the provided data field isn't meant to be an ESDT transfer\n     * @return {tokenIdentifier, amount} this function returns a pair of token identifier and amount to transfer\n     */\n    static extractFieldsFromEsdtTransferDataField(dataField) {\n        if (!dataField.startsWith(constants_1.ESDT_TRANSFER_FUNCTION_NAME + \"@\")) {\n            throw new errors_1.ErrInvalidEsdtTransferDataField();\n        }\n        let { args } = scArgumentsParser_1.ScArgumentsParser.parseSmartContractCallDataField(dataField);\n        if (args.length != 2) {\n            throw new errors_1.ErrInvalidEsdtTransferDataField();\n        }\n        let tokenIdentifier = args[0];\n        let amount = new bignumber_js_1.default(args[1], 16).toString(10);\n        return {\n            tokenIdentifier: tokenIdentifier,\n            amount: amount\n        };\n    }\n    /**\n     * This function checks if the data field represents a valid ESDT transfer call\n     * @param dataField this field represents the string to be checked if it would trigger an ESDT transfer call\n     * @return true if the provided data field is meant to be an ESDT transfer\n     */\n    static isEsdtTransferTransaction(dataField) {\n        if (!dataField.startsWith(constants_1.ESDT_TRANSFER_FUNCTION_NAME + \"@\")) {\n            return false;\n        }\n        let args;\n        try {\n            args = scArgumentsParser_1.ScArgumentsParser.parseSmartContractCallDataField(dataField).args;\n        }\n        catch (e) {\n            return false;\n        }\n        return args.length === 2;\n    }\n    /**\n     * getTxFieldsForEsdtTransfer returns the needed value, gasLimit and data field (in string format) for sending an amount of ESDT token\n     * @param tokenIdentifier this field represents the identifier of the token to transfer\n     * @param amount this field represents the denominated amount of the token to send\n     * @return {value, gasLimit, data} this function returns the value, the gas limit and the data field to use\n     */\n    static getTxFieldsForEsdtTransfer(tokenIdentifier, amount) {\n        const encodedAmount = new bignumber_js_1.default(amount, 10).toString(16);\n        const txDataField = [constants_1.ESDT_TRANSFER_FUNCTION_NAME, tokenIdentifier, encodedAmount].join(\"@\");\n        return {\n            value: constants_1.ESDT_TRANSFER_VALUE,\n            gasLimit: constants_1.ESDT_TRANSFER_GAS_LIMIT,\n            data: txDataField\n        };\n    }\n}\nexports.EsdtHelpers = EsdtHelpers;\n//# sourceMappingURL=esdtHelpers.js.map"]},"metadata":{},"sourceType":"script"}